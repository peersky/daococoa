export const meta = {
  author: "Tim Pechersky",
  date: "2023-04-07",
  title: "Готовимся к крипто операциям",
  description:
    "Настраиваемся для безопасных крипто операций. Лучшие практики и предполётный чеклист.",
  tags: ["russian", "accounts", "guides"],
  path: "setting-safe-enviroment-ru",
};

# {meta.title}

Продолжая цикл статей о **безопасного использования цифровых валют** хочу рассказать о том как настроить безопасную рабочую среду и какие "лучшие практики" стоит использовать для того что бы убедится что рассмотренные [в прошлой статье](https://peersky.xyz/blog/how-wallets-made-ru/) секреты вашего кошелька останутся секретами для всех кроме Вас. :)

Как мы уже разобрали из прошлой статьи, крипто кошелёк это по сути своего рода виртуальная банковская ячейка, в которой хранится печать, документы подписанные которой - валидны. И безопасность ключа, либо даже "чертежа" ключа (коим можно считать мнемонику) - это секрет который нужно тщательно хранить.

В прошлом, когда мы приходили в отделение банка, что особенного всегда есть в этом заведении? Хороший банк всегда обеспечивает безопасность и сохранность личной тайны клиента. Будучи банком сами себе мы должны обеспечить схожие условия себе сами когда собираемся работать с крипто кошельком.

В этой статье мы рассмотрим общие практики, они в общем то полезны не только в крипто операциях, но и в повседневной практике сёрфа в интернете. Для удобства я разобью статью на несколько категорий, которые можно воспринимать как "Предполётный чеклист" пилота по которым можно пройтись. Поехали!

## Лучшие практики

### Определяем назначение счетов

Вместо того что бы сгенерировать лишь один адрес(счёт) и хранить на нём всё, лучшим подходом будет заранее определить назначение счетов. Так к примеру вы можете создать такой план на листе с бумагой. Например выглядеть может следующим образом (по порядковому номеру генерации):

1. **Холодное хранилище** - _"я не храню личный ключ к этому счёту вообще нигде, на этот адрес я присылаю активы на долгое хранение и доступ к нему могу получить только через мнемонику"_
2. **Оперативный баланс** - Это мой основной адрес для операций, с этого счёта я совершаю крупные сделки и крупные переводы.
3. **Публичный адрес** - Адрес который я публикую как мой. К примеру можно зарегистрировать на [ENS](https://ens.domains). Так к примеру мне вы можете отправить благодарность за эту статью введя в строке получателя не адрес, а [peersky.eth](https://etherscan.io/name-lookup-search?id=peersky.eth)
4. **Семейный счёт** - Личный ключ к этому кошельку есть у моего супруга, родителей итд
5. **Счёт для ежедневных платежей** - Например для использования в мобильном платёжном приложении
   Итд.

При этом вы не обязаны строго следовать порядковым номерам, вы можете заранее запланировать например что кошелёк с порядковым номером `1234` предназначен для экстренного вывода активов в случае скомпрометированного личного ключа одного из других кошельков.

### Изоляция счетов

По умолчанию все программные кошельки будут работать с мнемоникой, однако это означает что мнемоника хранится в достаточно предсказуемым месте на файловой системе и защищена лишь паролем, который могут взломать подбором. Такая архитектура не является самой безопасной ровно как и необходимой.

**В любом программном кошельке будет опция импорта личного ключа** - это более безопасное решение позволяющее хранить в программе лишь нужные ключи генерированные от мнемоники хранимой в другом месте. Обратной стороной такого подхода будет то что генерация новых счетов тоже должна производится в другом месте.

Например из примера выше, можно понять что изоляция может быть следующей кафе:

- только счета с порядковыми номером 2-5 нужны на компьютере для совершения операций.
- только счет с порядковым номером 5 нужен на мобильном телефоне (для платежей в кафе и магазинах)
- порядковый номер 1 не должен никаким образом генерироваться не из каких примитивов хранимых в программах кошельков.

Так как мы определили назначение кошельков, мы можем смело сгенерировать все необходимые ключи для нужных счетов, после чего сделать сброс мнемоники на какую-то случайную до которой нам нет вообще никакого дела (NB: _следовательно генерировать кошельки в этой программе не стоит по сколько мы не храним эту мнемонику данную нам после сброса_) и добавить счета 2-5 в нашу программу на компьютере и счёт №5 на мобильное устройство.

Настоящую Мнемонику же мы можем хранить отдельно, известным только нам способом (например записанную на бумаге)

### Отведённое время

Хорошей практикой будет отвести выделенное время в которое вы не будете отвлекаться на посторонние факторы такие как звонки, посторонние разговоры итд.

Ваша цель - как можно быстрее закончить чувствительные операции и закрыть кошельки, очистить рабочее пространство и быть свободным.

### Постоянное присутствие

Не стоит покидать рабочее пространство пока операции не закончены. Если вам всё же необходимо покинуть рабочее пространство (например отойти в туалет) и вы не можете в полной мере контролировать доступ третих лиц в это время, то **лучшим решением будет прервать все операции полностью**, в любом случае, отходя даже на минуту от открытого кошелька - **хорошей практикой будет заблокировать компьютер либо телефон**

### Не подписывайте непонятные сообщения

Иногда приложение (dApp) может запросить от вас подпись для например аутентификации, либо для каких-либо операций. К примеру [продажа NFT на OpenSea](https://support.opensea.io/hc/en-us/articles/360063498333-How-do-I-sell-an-NFT-#:~:text=Selling%20an%20NFT%20using%20OpenSea&text=On%20OpenSea%2C%20navigate%20to%20the,an%20NFT%20to%20get%20started.)

Такие подписи всегда должны иметь ясное сообщение о том что вы подписываете. Специально для этого разработан [EIP-712 Typed message](https://eips.ethereum.org/EIPS/eip-712).

Пример запроса EIP712 полдписи:
![metamask-eip712-small](/metamask-eip712.png "metamask-eip712")

### Безопасное окружение

### Физически

Ваше рабочее пространство является точкой уязвимости во время важных финансовых операций, либо операций по настройке личных ключей и кошельков.

_Так например, плохая идея проводить операции в которых будет в открытом тексте видна мнемоника либо личные ключи из ресторана, кафе, либо на конференции._

Прежде чем начинать что-либо делать всегда убедитесь что нет камер которые направлены вам на клавиатуру, и нет никого кто может смотреть вам через плечо.

_Злоумышленнику может быть достаточно одной фотографии вашего экрана снятой на смартфон, либо записи с камеры видео наблюдения. По этому перед тем как начинать работать с крипто кошельком всегда оцените местность, где вы находитесь._

При этом если вы используете скажем мобильный телефон для платежа в кафе, то программа и то как она настроена должна так же обеспечивать тайну ваших секретов, старайтесь по возможности не использовать не пинкод а биометрию.

### Ваша машина

Помимо физической среды следует так же настроить рабочую среду внутри вашего устройства. В списке ниже я затрону тему касательно не только крипто среды, но и в целом безопасности ваших веб2 акаунтов.

- Используйте отдельного пользователя либо браузер для крипто операций
- Настройте шифрование файловой системы в вашей ОС
- Используйте сложный пароль и биометрию для доступа в вашу файловую систему
- настройте DNS в ваших сетевых настройках на доверенные сервера. Например [доверенные DNS от гугла](https://developers.google.com/speed/public-dns?hl=ru): 4.4.4.4 и 8.8.8.8
- Используйте по возможности отдельный от ОС менеджер паролей, имеющий аттестацию по сетевой безопасности, например [1password](https://1password.com/) либо [Keeper security](https://www.keepersecurity.com/) и сильный мастер-пароль. Это удобно и безопасно.
- Двух факторная аутентификация обязательна везде где возможно.
- Не используйте мобильные SMS для двух факторной аутентификации. Их легко обойти.
- Если Вы пользуетесь менеджером паролей, не храните там же двух факторную аутентификацию ни бэкап коды, это сведет на нет безопастность в случае если сам менеджер будет скомпрометирован.

В общем и целом лучшей практикой будет вообще иметь отдельное устройство (купить специальный компьютер) который будет использоваться только для операций с криптой либо для одной конкретной операции.

Советую посмотреть забавную историю о том как создателю Эфира Виталику Бутерину заслали Shiba токенов, в которой можно услышать как он подходил к безопасности операции с рыночной стоимостью в **миллиарды** долларов: [Youtube - Vitalik Buterin talked about Shiba Inu](https://youtu.be/9VynqkMMZyM)

### Сетевая безопасность

Публичный вайфай опасен. Помните об этом. Пользуясь публичным интернетом владелец рутера может сканировать ваш трафик либо даже пытаться подменить пакеты данных. Конечно мы не собираемся слать в открытом виде наши пароли и ключи, однако даже информация о том что кто-то в ресторане подключился к RPC эфира может сказать злоумышленнику о том что в зале есть потенциальная жертва.

Если ваши операции включают передачу данных по сети то лучшим решением будет либо совершать их с безопасного подключения, например вашей домашней личной сети, прямого включения к ISP.

**Хорошей практикой в публичных местах будет использовать VPN в публичных сетях, либо переключатся на свой личный мобильный интернет**

## Компьютерная гигиена

### Вирусы

Цифровые вирусы это реальность. Несмотря на то что производители компьютеров и ОС стараются обеспечить максимальную безопасность, всё же трояны до сих пор являются существенным риском.
Помним что практически все трояны это так или иначе действия пользователя.

Для минимизации таких рисков стоит максимально изолировать компьютер на котором будут проводится операции от ненадёжных действий.

Хорошей практикой будет

- Не устанавливать неизвестные программы из не надёжных источников
- Не использовать лишних плагинов в браузерах
- Немедленно удаляйте все файлы содержащие чувствительные данные как только они больше не нужны
- Не посещать сайты не поддерживающие **HTTPS** (настройте запрет в самом браузере)
- Регулярно очищайте историю ваших терминалов, кэши и кукизы
- Не подключайтесь к интернету если операцию можно сделать без сети
- Держите систему обновлённой и устанавливайте последние обновления по безопасности от производителя ОС

### На уровне блокчейна

Помимо гигиены на вашей машине вам следует понимать и следить за действиями и привилегиями выданными в сети.
Так к примеру структура как устроены ERC20 токены и NFT что для транзакции на DEXах и прочих макретплейсах вам нужно будет выдавать разрешения контрактам тратить ваши токены (Allowance, Approval). Часто эти контракты запрашивают сразу выдать им бесконечное разрешение.
![approval-metamask-small](/approval-metamask.png "approval-metamask")

**Лучшей практикой будет выставлять Allowance ровно на сумму требуемую для транзакции**. К примеру как это делается в [метамаске](https://support.metamask.io/hc/en-us/articles/6055177143579-How-to-customize-token-approvals-with-a-spending-cap)

Проверить уже выданные разрешения вы можете например на Ethereum здесь - [EtherScan token Approval checker](https://etherscan.io/tokenapprovalchecker)

Помимо этого если вы занимаетесь более углубленной деятельностью в блокчейне, например ваши счета могут совершать привилегированные действия над контрактом - имейте собственный реестр в котором вы записываете все привилегии и какой счёт имеет их.

Так же хорошей практикой будет не совершать транзакций на контракты которые считаются регуляторами "входными точками для хакеров". Так к примеру взаимодействие с Tornado Cash протоколом может привести в блэклистам на биржах поскольку они считают этот счёт подозрительным.

**Помните что все действия в блокчейне публично записаны** - не стоит вести нелегальную активность в блокчейне, так как в итоге всё это может быть проанализировано.

## Оперативный чеклист

Вместо заключения дам чеклист по которому можно пройти как пилот проходит чеклист перед взлётом.

- [ ] Я знаю что хочу сделать и понимаю сколько времени это займет
- [ ] Я знаю сеть в которой буду совершать операции
- [ ] Я знаю какие счета я буду использовать
- [ ] Я выделил необходимое время для моей задачи
- [ ] У меня есть достаточное количество топлива(gas) на моих счетах _[What is gas?](https://ethereum.org/en/developers/docs/gas/)_
- [ ] Я нахожусь в достаточно безопасном месте
- [ ] Мой компьютер хорошо настроен и настроен
- [ ] Моё сетевое подключение безопасно
- [ ] Адреса счетов на которые будут совершаться переводы верны
- [ ] Я понимаю последствия моей тразнакции
